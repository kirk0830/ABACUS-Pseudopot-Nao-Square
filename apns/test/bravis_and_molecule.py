# CITATION
# Bosoni E, Beal L, Bercx M, et al. 
# How to verify the precision of density-functional-theory implementations via 
# reproducible and universal workflows[J]. 
# Nature Reviews Physics, 2024, 6(1): 45-58.
ACWF_REFVOLUME = """
            Ac-X/BCC       45.9436890652
        Ac-X/Diamond      129.7619376361
            Ac-X/FCC       45.5506539230
             Ac-X/SC       49.8290621407
            Ag-X/BCC       17.9815994341
        Ag-X/Diamond       60.1384477535
            Ag-X/FCC       17.8385603821
             Ag-X/SC       20.8078166537
            Al-X/BCC       16.9256568722
        Al-X/Diamond       55.2581279179
            Al-X/FCC       16.4953590598
             Al-X/SC       20.1551394162
            Am-X/BCC       16.1910646994
        Am-X/Diamond       38.9260608838
            Am-X/FCC       17.3637417757
             Am-X/SC       16.1166162914
            Ar-X/BCC       53.3545313857
        Ar-X/Diamond      197.2037257853
            Ar-X/FCC       52.2763833345
             Ar-X/SC       65.2406881909
            As-X/BCC       19.0521510903
        As-X/Diamond       57.0334563896
            As-X/FCC       19.3175775190
             As-X/SC       20.3677497329
            At-X/BCC       40.0072565617
        At-X/Diamond      133.8244131673
            At-X/FCC       39.0306665408
             At-X/SC       46.1440668021
            Au-X/BCC       18.0420836978
        Au-X/Diamond       58.5415097463
            Au-X/FCC       17.9789494007
             Au-X/SC       20.7696027903
             B-X/BCC        6.1393552113
         B-X/Diamond       16.6263169088
             B-X/FCC        5.8915500544
              B-X/SC        6.7004880836
            Ba-X/BCC       63.3054105555
        Ba-X/Diamond      113.1699823796
            Ba-X/FCC       64.1140410061
             Ba-X/SC       61.6056180281
            Be-X/BCC        7.8157560018
        Be-X/Diamond       29.3739872910
            Be-X/FCC        7.8716206739
             Be-X/SC       10.2672356016
            Bi-X/BCC       31.6346675774
        Bi-X/Diamond       96.9022394411
            Bi-X/FCC       31.8104681271
             Bi-X/SC       35.2050582284
            Br-X/BCC       26.7842124781
        Br-X/Diamond       86.1711243924
            Br-X/FCC       26.4175363357
             Br-X/SC       29.8278511781
             C-X/BCC        6.6857220257
         C-X/Diamond       11.3915229468
             C-X/FCC        7.3216347712
              C-X/SC        5.5822112996
            Ca-X/BCC       42.1504734668
        Ca-X/Diamond      159.9693954411
            Ca-X/FCC       42.1942968575
             Ca-X/SC       43.5849131941
            Cd-X/BCC       23.4195726366
        Cd-X/Diamond       74.9080478398
            Cd-X/FCC       22.8412781751
             Cd-X/SC       26.9236002457
            Ce-X/BCC       27.3239643916
        Ce-X/Diamond       60.3696280203
            Ce-X/FCC       26.5223557737
             Ce-X/SC       24.9210139881
            Cl-X/BCC       21.4547444716
        Cl-X/Diamond       67.5148577560
            Cl-X/FCC       21.2881895239
             Cl-X/SC       23.4640292893
            Cm-X/BCC       16.5207822537
        Cm-X/Diamond       38.6523626094
            Cm-X/FCC       17.4924664960
             Cm-X/SC       16.3990024768
            Co-X/BCC       10.5447926821
        Co-X/Diamond       29.7694335456
            Co-X/FCC       10.3083927827
             Co-X/SC       11.8932667993
            Cr-X/BCC       11.5481993396
        Cr-X/Diamond       33.0709117517
            Cr-X/FCC       11.8859164649
             Cr-X/SC       12.8069580127
            Cs-X/BCC      116.8417228518
        Cs-X/Diamond      377.5119512083
            Cs-X/FCC      117.3605789432
             Cs-X/SC      128.3590552257
            Cu-X/BCC       12.0045162940
        Cu-X/Diamond       38.3543187692
            Cu-X/FCC       11.9522246523
             Cu-X/SC       13.9349731242
            Dy-X/BCC       32.2885692044
        Dy-X/Diamond       46.0203764469
            Dy-X/FCC       32.4766359634
             Dy-X/SC       31.8571930831
            Er-X/BCC       33.9307067591
        Er-X/Diamond      160.7182113742
            Er-X/FCC       34.8228848521
             Er-X/SC       35.9430359073
            Eu-X/BCC       26.1340832200
        Eu-X/Diamond       41.3650702486
            Eu-X/FCC       24.9919769933
             Eu-X/SC       17.7951482963
             F-X/BCC       10.0841273303
         F-X/Diamond       29.0048013514
             F-X/FCC       10.1469872576
              F-X/SC       10.5209419861
            Fe-X/BCC       10.5004841964
        Fe-X/Diamond       28.9244448081
            Fe-X/FCC       10.2602117762
             Fe-X/SC       11.6513477719
            Fr-X/BCC      116.4923124868
        Fr-X/Diamond      384.0321596406
            Fr-X/FCC      117.1629536099
             Fr-X/SC      132.1740858506
            Ga-X/BCC       19.2055876101
        Ga-X/Diamond       50.8380451983
            Ga-X/FCC       18.9465000846
             Ga-X/SC       20.1173121537
            Gd-X/BCC       28.9474037903
        Gd-X/Diamond       41.8942701551
            Gd-X/FCC       27.9938704976
             Gd-X/SC       20.8095989335
            Ge-X/BCC       19.2694953095
        Ge-X/Diamond       47.8265898364
            Ge-X/FCC       19.5824508015
             Ge-X/SC       19.9417483114
             H-X/BCC        2.9667742929
         H-X/Diamond        6.8311116562
             H-X/FCC        2.9648091126
              H-X/SC        3.0866686939
            He-X/BCC       18.0303880567
        He-X/Diamond       64.2148789366
            He-X/FCC       17.7725807210
             He-X/SC       21.4852711323
            Hf-X/BCC       22.3047194703
        Hf-X/Diamond       70.1577406488
            Hf-X/FCC       22.5676034192
             Hf-X/SC       24.7811393086
            Hg-X/BCC       29.2371602125
        Hg-X/Diamond      112.5823446507
            Hg-X/FCC       32.3477976932
             Hg-X/SC       29.8543233498
            Ho-X/BCC       33.2672852865
        Ho-X/Diamond       50.8501121827
            Ho-X/FCC       33.8917393870
             Ho-X/SC       34.2940697226
             I-X/BCC       35.9867670342
         I-X/Diamond      121.1452775012
             I-X/FCC       35.1048845030
              I-X/SC       41.5631544369
            In-X/BCC       27.7805802898
        In-X/Diamond       76.4320586824
            In-X/FCC       27.5100988618
             In-X/SC       29.5502109822
            Ir-X/BCC       15.0556415096
        Ir-X/Diamond       43.1935547990
            Ir-X/FCC       14.5049941291
             Ir-X/SC       16.9945041257
             K-X/BCC       73.7795179893
         K-X/Diamond      223.8044852857
             K-X/FCC       74.0044361285
              K-X/SC       79.3544129228
            Kr-X/BCC       67.4634311123
        Kr-X/Diamond      249.7079835831
            Kr-X/FCC       66.0417653419
             Kr-X/SC       82.6645424965
            La-X/BCC       37.8175702599
        La-X/Diamond       74.6380534648
            La-X/FCC       36.9468915219
             La-X/SC       36.7450629470
            Li-X/BCC       20.2674652133
        Li-X/Diamond       51.3867180352
            Li-X/FCC       20.2244785929
             Li-X/SC       20.4088019741
            Lu-X/BCC       29.6257064032
        Lu-X/Diamond      101.2182490481
            Lu-X/FCC       28.9714042450
             Lu-X/SC       32.9400269740
            Mg-X/BCC       22.9172569645
        Mg-X/Diamond       80.8516729950
            Mg-X/FCC       23.1252461440
             Mg-X/SC       27.5805850687
            Mn-X/BCC       10.7808268397
        Mn-X/Diamond       30.3432739437
            Mn-X/FCC       10.7471443132
             Mn-X/SC       11.8988403344
            Mo-X/BCC       15.7925810470
        Mo-X/Diamond       46.0075591929
            Mo-X/FCC       16.0351302591
             Mo-X/SC       17.5962610036
             N-X/BCC        7.2347133844
         N-X/Diamond       18.3533073287
             N-X/FCC        7.6012909873
              N-X/SC        6.4799301718
            Na-X/BCC       37.0150641100
        Na-X/Diamond      109.1430788906
            Na-X/FCC       37.0989860953
             Na-X/SC       39.7513602453
            Nb-X/BCC       18.1415011497
        Nb-X/Diamond       51.5612380786
            Nb-X/FCC       18.7677989613
             Nb-X/SC       20.1149109148
            Nd-X/BCC       21.0678209810
        Nd-X/Diamond       47.0991055430
            Nd-X/FCC       22.7647561474
             Nd-X/SC       18.0765197733
            Ne-X/BCC       24.7112468179
        Ne-X/Diamond       89.1474187039
            Ne-X/FCC       24.3028219458
             Ne-X/SC       29.7451962147
            Ni-X/BCC       10.8950930618
        Ni-X/Diamond       33.0121380345
            Ni-X/FCC       10.8348969207
             Ni-X/SC       12.5590185628
            Np-X/BCC       17.8079227825
        Np-X/Diamond       42.9533016321
            Np-X/FCC       19.2945468597
             Np-X/SC       17.2734160816
             O-X/BCC        7.7862826653
         O-X/Diamond       21.3628964776
             O-X/FCC        7.9987519984
              O-X/SC        7.9535032234
            Os-X/BCC       14.7808432251
        Os-X/Diamond       42.9003271345
            Os-X/FCC       14.3408590455
             Os-X/SC       16.7303790128
             P-X/BCC       14.2301643213
         P-X/Diamond       41.3183089373
             P-X/FCC       14.5635813315
              P-X/SC       14.6564493780
            Pa-X/BCC       24.7971150304
        Pa-X/Diamond       61.0193764146
            Pa-X/FCC       25.2979382957
             Pa-X/SC       24.0207081049
            Pb-X/BCC       31.9704284094
        Pb-X/Diamond       88.0899664601
            Pb-X/FCC       32.0330693820
             Pb-X/SC       34.4758419297
            Pd-X/BCC       15.4442899164
        Pd-X/Diamond       49.0125255975
            Pd-X/FCC       15.3254220778
             Pd-X/SC       17.8613427336
            Pm-X/BCC       20.3578671427
        Pm-X/Diamond       43.3046763305
            Pm-X/FCC       22.2454982473
             Pm-X/SC       17.2982038540
            Po-X/BCC       32.8538744328
        Po-X/Diamond      104.9634814464
            Po-X/FCC       32.5633304447
             Po-X/SC       37.5954709759
            Pr-X/BCC       23.1413663276
        Pr-X/Diamond       52.4401030751
            Pr-X/FCC       24.0941010592
             Pr-X/SC       20.1508127695
            Pt-X/BCC       15.8389750612
        Pt-X/Diamond       48.2299658537
            Pt-X/FCC       15.6559513760
             Pt-X/SC       18.0860881007
            Pu-X/BCC       16.5643372636
        Pu-X/Diamond       40.4075680763
            Pu-X/FCC       17.8021327417
             Pu-X/SC       16.3671826034
            Ra-X/BCC       70.9668672681
        Ra-X/Diamond      339.3371556818
            Ra-X/FCC       71.6269845364
             Ra-X/SC       75.3455997294
            Rb-X/BCC       91.1440710492
        Rb-X/Diamond      282.7553207612
            Rb-X/FCC       91.4274679406
             Rb-X/SC       98.9794397816
            Re-X/BCC       15.1044598171
        Re-X/Diamond       45.1488092366
            Re-X/FCC       15.0163498073
             Re-X/SC       17.1611268525
            Rh-X/BCC       14.4742145663
        Rh-X/Diamond       41.9004577066
            Rh-X/FCC       14.0504550878
             Rh-X/SC       16.3052925485
            Rn-X/BCC       95.4471230782
        Rn-X/Diamond      353.9049285433
            Rn-X/FCC       93.1564256810
             Rn-X/SC      117.6672115419
            Ru-X/BCC       14.2356061964
        Ru-X/Diamond       40.5863643979
            Ru-X/FCC       13.8366151623
             Ru-X/SC       15.8381291955
             S-X/BCC       15.7618462400
         S-X/Diamond       48.5621194269
             S-X/FCC       15.8806885358
              S-X/SC       17.2197235453
            Sb-X/BCC       27.2257889203
        Sb-X/Diamond       85.3650954131
            Sb-X/FCC       27.4896291741
             Sb-X/SC       30.0634121990
            Sc-X/BCC       24.8858518758
        Sc-X/Diamond       68.9151380008
            Sc-X/FCC       24.6868520662
             Sc-X/SC       26.1480548969
            Se-X/BCC       20.3600286206
        Se-X/Diamond       63.5107554328
            Se-X/FCC       20.3778732432
             Se-X/SC       22.6834109000
            Si-X/BCC       14.6451673299
        Si-X/Diamond       40.9149469095
            Si-X/FCC       14.4822031565
             Si-X/SC       16.2292642666
            Sm-X/BCC       21.6458724878
        Sm-X/Diamond       41.8054697730
            Sm-X/FCC       22.8284101769
             Sm-X/SC       17.1965125100
            Sn-X/BCC       27.6472928166
        Sn-X/Diamond       73.6877592925
            Sn-X/FCC       28.0088425653
             Sn-X/SC       29.4530306864
            Sr-X/BCC       54.0128807068
        Sr-X/Diamond      223.7821246728
            Sr-X/FCC       54.8922650546
             Sr-X/SC       57.1290143708
            Ta-X/BCC       18.2919921205
        Ta-X/Diamond       56.8185715387
            Ta-X/FCC       18.8393711237
             Ta-X/SC       20.6669151965
            Tb-X/BCC       30.9008337902
        Tb-X/Diamond       43.3929318627
            Tb-X/FCC       30.5520741878
             Tb-X/SC       27.8199432306
            Tc-X/BCC       14.6195757062
        Tc-X/Diamond       42.4918607430
            Tc-X/FCC       14.5126740985
             Tc-X/SC       16.2350067792
            Te-X/BCC       28.5152914419
        Te-X/Diamond       92.8002629931
            Te-X/FCC       28.2787257642
             Te-X/SC       32.7934878779
            Th-X/BCC       32.5677469591
        Th-X/Diamond       91.4653155955
            Th-X/FCC       32.1839319361
             Th-X/SC       35.3321431170
            Ti-X/BCC       17.2668387055
        Ti-X/Diamond       45.8421534674
            Ti-X/FCC       17.3945872331
             Ti-X/SC       18.4131750886
            Tl-X/BCC       31.4143781862
        Tl-X/Diamond       90.2879174095
            Tl-X/FCC       31.1402049921
             Tl-X/SC       34.3940693000
            Tm-X/BCC       34.3583819751
        Tm-X/Diamond      163.3512533799
            Tm-X/FCC       35.3320901938
             Tm-X/SC       37.2077575159
             U-X/BCC       20.2661778805
         U-X/Diamond       49.5199753572
             U-X/FCC       21.7133355135
              U-X/SC       19.1223788669
             V-X/BCC       13.4607654817
         V-X/Diamond       37.2400616134
             V-X/FCC       13.9049548185
              V-X/SC       14.6801017804
             W-X/BCC       16.1454752416
         W-X/Diamond       49.5504586465
             W-X/FCC       16.4578846361
              W-X/SC       18.3694598023
            Xe-X/BCC       89.0348898020
        Xe-X/Diamond      331.8911738830
            Xe-X/FCC       87.0069651578
             Xe-X/SC      109.8051846381
             Y-X/BCC       33.0304565057
         Y-X/Diamond       87.5187101972
             Y-X/FCC       32.4715444515
              Y-X/SC       34.8169697264
            Yb-X/BCC       34.6395882212
        Yb-X/Diamond      164.1166906281
            Yb-X/FCC       35.7043529273
             Yb-X/SC       38.6416396501
            Zn-X/BCC       15.3751088074
        Zn-X/Diamond       49.3473967449
            Zn-X/FCC       15.1620084721
             Zn-X/SC       18.1790323898
            Zr-X/BCC       22.8447760184
        Zr-X/Diamond       61.9100700077
            Zr-X/FCC       23.2133785116
             Zr-X/SC       24.7431321708
              Ac-X2O        80.3766777041
             Ac-X2O3       203.3261179079
             Ac-X2O5       207.7679798530
               Ac-XO        38.9923506816
              Ac-XO2        52.9617913856
              Ac-XO3        91.4419527965
              Ag-X2O        48.3880881978
             Ag-X2O3       131.2721383030
             Ag-X2O5       149.9279954823
               Ag-XO        25.5092348062
              Ag-XO2        34.3833555569
              Ag-XO3        65.2341632068
              Al-X2O        46.2166344769
             Al-X2O3        98.4792078105
             Al-X2O5       126.1434855577
               Al-XO        22.4565249375
              Al-XO2        26.3009169995
              Al-XO3        49.7439004397
              Am-X2O        45.4196361191
             Am-X2O3       144.5943669149
             Am-X2O5       148.5763900136
               Am-XO        26.6655358077
              Am-XO2        36.9632369401
              Am-XO3        67.8535567672
              Ar-X2O       113.2584356585
             Ar-X2O3       206.3629890023
             Ar-X2O5       185.3897745373
               Ar-XO        39.4316091337
              Ar-XO2        51.3385726423
              Ar-XO3        68.3259444649
              As-X2O        47.8129303101
             As-X2O3       130.5791083601
             As-X2O5       144.0308776299
               As-XO        27.1913322371
              As-XO2        31.4988116079
              As-XO3        47.3191975099
              At-X2O        77.7911279819
             At-X2O3       177.4866261524
             At-X2O5       169.0902164530
               At-XO        40.7742724202
              At-XO2        43.8345877770
              At-XO3        71.7160963245
              Au-X2O        49.4529895615
             Au-X2O3       134.2681786135
             Au-X2O5       150.3619898782
               Au-XO        26.8818731509
              Au-XO2        35.0035610279
              Au-XO3        63.9619529494
               B-X2O        30.0285214751
              B-X2O3        71.9701748768
              B-X2O5       108.7466438012
                B-XO        14.7104767712
               B-XO2        20.3735387452
               B-XO3        33.6288291901
              Ba-X2O        79.8910277264
             Ba-X2O3       233.8431929508
             Ba-X2O5       227.2080465907
               Ba-XO        43.3059052231
              Ba-XO2        60.3420628173
              Ba-XO3        91.2167580785
              Be-X2O        26.8336863136
             Be-X2O3        77.5992991627
             Be-X2O5       114.6490815768
               Be-XO        12.1241235324
              Be-XO2        22.1853704904
              Be-XO3        38.9920668656
              Bi-X2O        69.2416402127
             Bi-X2O3       174.8794659220
             Bi-X2O5       177.9474678741
               Bi-XO        36.0250475739
              Bi-XO2        42.0731244321
              Bi-XO3        74.0434279064
              Br-X2O        61.6284737500
             Br-X2O3       147.3373879278
             Br-X2O5       155.9727261571
               Br-XO        31.1066260653
              Br-XO2        37.0137172232
              Br-XO3        58.2562747594
               C-X2O        28.5543396986
              C-X2O3        84.5380726032
              C-X2O5       117.2300823464
                C-XO        15.7017518066
               C-XO2        22.7563943071
               C-XO3        32.9192184906
              Ca-X2O        56.0930565565
             Ca-X2O3       159.8707057444
             Ca-X2O5       168.8412197826
               Ca-XO        28.1902806381
              Ca-XO2        42.3071779782
              Ca-XO3        94.2821671350
              Cd-X2O        53.0827454489
             Cd-X2O3       146.5042032577
             Cd-X2O5       161.2378382603
               Cd-XO        27.0939526923
              Cd-XO2        38.5366078605
              Cd-XO3        73.1521276749
              Ce-X2O        56.1033720727
             Ce-X2O3       164.2541846341
             Ce-X2O5       168.0940830138
               Ce-XO        31.0393106727
              Ce-XO2        40.7934990661
              Ce-XO3        81.6526612315
              Cl-X2O        54.5599950102
             Cl-X2O3       135.2505227618
             Cl-X2O5       150.3546786468
               Cl-XO        26.9586604193
              Cl-XO2        34.6976212954
              Cl-XO3        52.0056080800
              Cm-X2O        45.8647310715
             Cm-X2O3       144.5823454157
             Cm-X2O5       149.2067378771
               Cm-XO        26.7942409457
              Cm-XO2        36.6576049650
              Cm-XO3        67.2956544608
              Co-X2O        29.8356351327
             Co-X2O3        90.6256381552
             Co-X2O5       117.9115829169
               Co-XO        17.2707951704
              Co-XO2        25.0336824451
              Co-XO3        47.1377651448
              Cr-X2O        30.4416204626
             Cr-X2O3        96.5585360638
             Cr-X2O5       116.2656068642
               Cr-XO        17.6642082583
              Cr-XO2        25.4250183278
              Cr-XO3        46.8744726750
              Cs-X2O        96.4963143185
             Cs-X2O3       283.3683112894
             Cs-X2O5       244.2227704567
               Cs-XO        53.2964719758
              Cs-XO2        63.5558422408
              Cs-XO3        76.2032196701
              Cu-X2O        34.5388242469
             Cu-X2O3       103.8005032418
             Cu-X2O5       128.4904502355
               Cu-XO        19.1071794760
              Cu-XO2        28.2331352393
              Cu-XO3        52.0132930039
              Dy-X2O        51.7919063548
             Dy-X2O3       148.5715626281
             Dy-X2O5       155.3517188345
               Dy-XO        28.1758895566
              Dy-XO2        36.9449340081
              Dy-XO3        71.7798654427
              Er-X2O        53.8145908104
             Er-X2O3       147.3747220053
             Er-X2O5       156.0250220860
               Er-XO        28.0240324329
              Er-XO2        36.9035426176
              Er-XO3        73.1595986199
              Eu-X2O        50.0016674176
             Eu-X2O3       152.3283651800
             Eu-X2O5       156.7647836064
               Eu-XO        28.5041443981
              Eu-XO2        37.6917809771
              Eu-XO3        71.0939450518
               F-X2O        30.9657004360
              F-X2O3       112.6454197660
              F-X2O5       121.5853790142
                F-XO        18.8566682765
               F-XO2        30.8381241671
               F-XO3        53.3246172860
              Fe-X2O        29.3935964332
             Fe-X2O3        90.8708646557
             Fe-X2O5       116.0166370854
               Fe-XO        17.1360230225
              Fe-XO2        24.1935683216
              Fe-XO3        45.9356803628
              Fr-X2O       106.7081347575
             Fr-X2O3       262.1912050416
             Fr-X2O5       229.9180340259
               Fr-XO        55.3923530127
              Fr-XO2        58.9145705183
              Fr-XO3        79.5192200796
              Ga-X2O        53.0428316908
             Ga-X2O3       110.9910906199
             Ga-X2O5       135.6777983406
               Ga-XO        24.3519260048
              Ga-XO2        29.2616747718
              Ga-XO3        57.4702012782
              Gd-X2O        50.4485751481
             Gd-X2O3       151.0196063737
             Gd-X2O5       156.1541161775
               Gd-XO        28.3619672301
              Gd-XO2        37.3613239688
              Gd-XO3        71.1122124637
              Ge-X2O        49.6826646553
             Ge-X2O3       121.2068258931
             Ge-X2O5       139.5168563037
               Ge-XO        27.1224746038
              Ge-XO2        28.1907774432
              Ge-XO3        51.0739691118
               H-X2O        11.9634789175
              H-X2O3        61.8461906208
              H-X2O5       103.3476058561
                H-XO        10.0278485558
               H-XO2        19.1045964279
               H-XO3        31.0892857962
              He-X2O        92.1784561524
             He-X2O3        94.2892559915
             He-X2O5       112.7969692598
               He-XO        31.5284199339
              He-XO2        24.7769884438
              He-XO3        43.0595390987
              Hf-X2O        48.6464001217
             Hf-X2O3       128.3593106825
             Hf-X2O5       142.6630326850
               Hf-XO        24.2328779984
              Hf-XO2        33.1171122998
              Hf-XO3        70.8264128422
              Hg-X2O        56.1814034425
             Hg-X2O3       152.6799425976
             Hg-X2O5       166.5429926971
               Hg-XO        29.8153372463
              Hg-XO2        39.3032040368
              Hg-XO3        72.6308698628
              Ho-X2O        52.7205845390
             Ho-X2O3       147.7723745480
             Ho-X2O5       155.4986381977
               Ho-XO        28.0975159321
              Ho-XO2        36.8805913951
              Ho-XO3        72.3695555480
               I-X2O        72.1883751960
              I-X2O3       167.7015763436
              I-X2O5       163.0032978878
                I-XO        38.0121877327
               I-XO2        41.4430873225
               I-XO3        60.8593853544
              In-X2O        65.9312824740
             In-X2O3       140.3797295757
             In-X2O5       156.8475436643
               In-XO        30.4930200465
              In-XO2        36.4728530561
              In-XO3        74.7677162136
              Ir-X2O        40.3357735585
             Ir-X2O3       111.0380250657
             Ir-X2O5       130.8900994214
               Ir-XO        23.4070917871
              Ir-XO2        30.4120613860
              Ir-XO3        53.8620578775
               K-X2O        68.0023195239
              K-X2O3       227.5858556227
              K-X2O5       198.7688451835
                K-XO        42.7454284123
               K-XO2        58.3642913165
               K-XO3       136.5345806915
              Kr-X2O       118.9585508090
             Kr-X2O3       194.3219841319
             Kr-X2O5       192.3183698028
               Kr-XO        40.0747088055
              Kr-XO2        47.5424167506
              Kr-XO3        68.0569860489
              La-X2O        65.1355386334
             La-X2O3       182.5166466189
             La-X2O5       189.9565090452
               La-XO        34.4311484304
              La-XO2        47.8793568195
              La-XO3        90.8722688258
              Li-X2O        24.7219605443
             Li-X2O3        89.4702921980
             Li-X2O5       123.6921630074
               Li-XO        16.8258201901
              Li-XO2        24.9222846589
              Li-XO3        46.0891562911
              Lu-X2O        54.0708402418
             Lu-X2O3       144.4264116871
             Lu-X2O5       157.8745332570
               Lu-XO        26.5602101356
              Lu-XO2        37.2635986859
              Lu-XO3        78.0837671769
              Mg-X2O        44.8618300004
             Mg-X2O3       113.5476089519
             Mg-X2O5       138.8960033091
               Mg-XO        19.2490386066
              Mg-XO2        30.5903825674
              Mg-XO3        62.1387718253
              Mn-X2O        29.5693802077
             Mn-X2O3        92.9309317477
             Mn-X2O5       115.3256913874
               Mn-XO        17.2932289385
              Mn-XO2        24.6535535186
              Mn-XO3        45.6058126671
              Mo-X2O        39.7169735907
             Mo-X2O3       113.5385735057
             Mo-X2O5       125.8060190815
               Mo-XO        21.5171720187
              Mo-XO2        29.7284058776
              Mo-XO3        55.6191432623
               N-X2O        26.6681958251
              N-X2O3        91.3494028026
              N-X2O5       114.4677447247
                N-XO        15.3380640371
               N-XO2        25.5104332087
               N-XO3        39.7094461386
              Na-X2O        43.7112100282
             Na-X2O3       141.7168154308
             Na-X2O5       148.7164926893
               Na-XO        27.7597376236
              Na-XO2        36.6738422342
              Na-XO3        82.1489910475
              Nb-X2O        43.2827877548
             Nb-X2O3       120.1653333610
             Nb-X2O5       131.5612718648
               Nb-XO        22.3758352560
              Nb-XO2        31.2454840105
              Nb-XO3        61.6234280997
              Nd-X2O        50.5591396348
             Nd-X2O3       157.2750957000
             Nd-X2O5       159.4340420582
               Nd-XO        29.4626260319
              Nd-XO2        39.0965288868
              Nd-XO3        72.6469008596
              Ne-X2O        95.6869274896
             Ne-X2O3       163.8552505096
             Ne-X2O5       139.0532952358
               Ne-XO        47.0351782826
              Ne-XO2        38.9072800679
              Ne-XO3        80.7405007273
              Ni-X2O        31.6392005202
             Ni-X2O3        96.0006773685
             Ni-X2O5       121.4339802223
               Ni-XO        17.9950255747
              Ni-XO2        26.2012164588
              Ni-XO3        49.2051055590
              Np-X2O        47.2486829039
             Np-X2O3       147.2543455647
             Np-X2O5       149.6294544168
               Np-XO        27.3325614075
              Np-XO2        38.0680577969
              Np-XO3        70.2879539764
               O-X2O        27.1134142708
              O-X2O3        95.7503819847
              O-X2O5        57.9331034472
                O-XO         7.9535387418
               O-XO2        27.1134132505
               O-XO3        44.7795608313
              Os-X2O        39.5539684355
             Os-X2O3       109.4116346728
             Os-X2O5       126.3678623635
               Os-XO        22.5348020963
              Os-XO2        28.7951023377
              Os-XO3        53.0873750759
               P-X2O        40.0277151049
              P-X2O3       112.8727351727
              P-X2O5       130.5423350374
                P-XO        24.3010256685
               P-XO2        27.2024253336
               P-XO3        37.0099306593
              Pa-X2O        56.2923013639
             Pa-X2O3       157.6024864189
             Pa-X2O5       159.6642739743
               Pa-XO        30.0893668636
              Pa-XO2        40.6462515052
              Pa-XO3        77.7040076752
              Pb-X2O        70.3198181327
             Pb-X2O3       172.6082533621
             Pb-X2O5       176.4586405594
               Pb-XO        36.5120236863
              Pb-XO2        39.5782040373
              Pb-XO3        79.2712780011
              Pd-X2O        42.2132978382
             Pd-X2O3       118.0528081773
             Pd-X2O5       137.9239149746
               Pd-XO        23.3092916044
              Pd-XO2        31.3917198094
              Pd-XO3        58.5880912560
              Pm-X2O        49.8337932875
             Pm-X2O3       155.2044954721
             Pm-X2O5       158.3022416112
               Pm-XO        29.0223921974
              Pm-XO2        38.5404842073
              Pm-XO3        71.7225024029
              Po-X2O        70.3286829065
             Po-X2O3       169.2578665551
             Po-X2O5       170.6733982093
               Po-XO        37.3373519551
              Po-XO2        41.7848255080
              Po-XO3        70.8861203510
              Pr-X2O        52.3090919345
             Pr-X2O3       159.9823006342
             Pr-X2O5       161.1448735980
               Pr-XO        30.0796470220
              Pr-XO2        39.8130143487
              Pr-XO3        76.6836070362
              Pt-X2O        43.2242783913
             Pt-X2O3       121.2322029771
             Pt-X2O5       138.5253161952
               Pt-XO        24.6512617490
              Pt-XO2        32.2861087760
              Pt-XO3        57.3360618653
              Pu-X2O        45.8569164390
             Pu-X2O3       145.3471383222
             Pu-X2O5       148.4904181466
               Pu-XO        26.8435559576
              Pu-XO2        37.4046534874
              Pu-XO3        68.8389624153
              Ra-X2O        93.8522223131
             Ra-X2O3       253.1466521729
             Ra-X2O5       243.0891440656
               Ra-XO        47.8467298342
              Ra-XO2        63.8569093381
              Ra-XO3        87.7288712643
              Rb-X2O        81.0780575565
             Rb-X2O3       269.0813732808
             Rb-X2O5       228.6914182925
               Rb-XO        48.7860872246
              Rb-XO2        69.0722338679
              Rb-XO3       109.6419543319
              Re-X2O        40.1922062859
             Re-X2O3       110.6936185310
             Re-X2O5       124.4787949236
               Re-XO        22.1149327399
              Re-XO2        29.3036682655
              Re-XO3        53.8019563486
              Rh-X2O        38.8641253839
             Rh-X2O3       108.8655092282
             Rh-X2O5       130.8322231544
               Rh-XO        22.0075909487
              Rh-XO2        29.5970403388
              Rh-XO3        54.2628837505
              Rn-X2O       136.6806210610
             Rn-X2O3       203.1429842418
             Rn-X2O5       182.1973228352
               Rn-XO        47.5371600877
              Rn-XO2        48.6845699174
              Rn-XO3        72.1167297681
              Ru-X2O        37.8846552404
             Ru-X2O3       107.3070598216
             Ru-X2O5       126.5824285038
               Ru-XO        21.4073747092
              Ru-XO2        28.1970608544
              Ru-XO3        52.5000076645
               S-X2O        42.6961517737
              S-X2O3       117.2654632716
              S-X2O5       134.1569280085
                S-XO        24.6823709028
               S-XO2        29.7406405798
               S-XO3        39.1448761247
              Sb-X2O        61.5804023617
             Sb-X2O3       157.4043022197
             Sb-X2O5       157.7596931952
               Sb-XO        33.6204451416
              Sb-XO2        37.5685165421
              Sb-XO3        60.2003631631
              Sc-X2O        43.1201936530
             Sc-X2O3       124.4359621005
             Sc-X2O5       142.7497334544
               Sc-XO        22.3324559129
              Sc-XO2        32.9881625312
              Sc-XO3        70.4980301314
              Se-X2O        49.9165404436
             Se-X2O3       132.2819132938
             Se-X2O5       143.8666792862
               Se-XO        28.3532491761
              Se-XO2        33.0733919904
              Se-XO3        49.8353711603
              Si-X2O        42.6794330097
             Si-X2O3        97.6418155141
             Si-X2O5       122.0201687316
               Si-XO        24.5917026545
              Si-XO2        24.0545402018
              Si-XO3        41.7791767426
              Sm-X2O        49.7289588739
             Sm-X2O3       153.5755593627
             Sm-X2O5       157.4516222710
               Sm-XO        28.7142061164
              Sm-XO2        38.0824887360
              Sm-XO3        71.2926208460
              Sn-X2O        63.5174545643
             Sn-X2O3       145.0015751259
             Sn-X2O5       153.5725564040
               Sn-XO        33.5364669546
              Sn-XO2        34.0055224631
              Sn-XO3        67.6676018020
              Sr-X2O        70.1546013506
             Sr-X2O3       195.2879962777
             Sr-X2O5       195.5643501667
               Sr-XO        35.0547267446
              Sr-XO2        51.2882143740
              Sr-XO3       113.8355848879
              Ta-X2O        45.0236617370
             Ta-X2O3       119.9256007285
             Ta-X2O5       131.2742524427
               Ta-XO        22.8579339154
              Ta-XO2        31.3933230348
              Ta-XO3        61.7485941109
              Tb-X2O        51.0339807992
             Tb-X2O3       149.7003449040
             Tb-X2O5       155.6324192419
               Tb-XO        28.2595711512
              Tb-XO2        37.1049093305
              Tb-XO3        71.3488657512
              Tc-X2O        38.3687383603
             Tc-X2O3       109.2283120873
             Tc-X2O5       124.6038329324
               Tc-XO        21.2150857148
              Tc-XO2        28.7226282497
              Tc-XO3        53.1018590218
              Te-X2O        62.9028621353
             Te-X2O3       157.4147157462
             Te-X2O5       159.5213569309
               Te-XO        34.8867565540
              Te-XO2        39.0599814046
              Te-XO3        56.8702855170
              Th-X2O        68.7894370444
             Th-X2O3       174.9462606148
             Th-X2O5       178.1984812275
               Th-XO        33.1491064962
              Th-XO2        44.3167220370
              Th-XO3        84.9633766228
              Ti-X2O        36.3161984048
             Ti-X2O3       108.5305539233
             Ti-X2O5       127.4653908398
               Ti-XO        19.6185774228
              Ti-XO2        28.1808210508
              Ti-XO3        57.3496952636
              Tl-X2O        72.2312455719
             Tl-X2O3       159.2931262925
             Tl-X2O5       171.9695385865
               Tl-XO        33.9597980545
              Tl-XO2        40.7123386589
              Tl-XO3        79.0397076100
              Tm-X2O        55.1541650605
             Tm-X2O3       147.3739118596
             Tm-X2O5       156.9139177634
               Tm-XO        27.9740463350
              Tm-XO2        37.0316849906
              Tm-XO3        74.2319233531
               U-X2O        50.1344844244
              U-X2O3       150.8171940460
              U-X2O5       152.5408494440
                U-XO        28.3581759359
               U-XO2        39.0248310466
               U-XO3        72.2298186021
               V-X2O        32.7156506012
              V-X2O3       101.5697384042
              V-X2O5       119.9363655564
                V-XO        18.3183767899
               V-XO2        26.5774629710
               V-XO3        50.2401988233
               W-X2O        41.7824234480
              W-X2O3       114.2686656339
              W-X2O5       125.5626796561
                W-XO        22.2350567385
               W-XO2        30.1451598060
               W-XO3        56.0469667625
              Xe-X2O       137.2044953864
             Xe-X2O3       197.8726987592
             Xe-X2O5       183.5134022044
               Xe-XO        45.2507480839
              Xe-XO2        47.3671462186
              Xe-XO3        66.9198420841
               Y-X2O        56.0274734537
              Y-X2O3       152.5278120094
              Y-X2O5       164.9592081970
                Y-XO        28.0544949059
               Y-XO2        40.1908044992
               Y-XO3        88.9188564262
              Yb-X2O        57.4630629302
             Yb-X2O3       147.8453493454
             Yb-X2O5       158.4856946443
               Yb-XO        27.9929501938
              Yb-XO2        37.3031960020
              Yb-XO3        75.6986315281
              Zn-X2O        40.6683025217
             Zn-X2O3       113.2545943477
             Zn-X2O5       137.0405851729
               Zn-XO        20.2777965238
              Zn-XO2        30.3929475221
              Zn-XO3        56.5507046843
              Zr-X2O        48.0870088917
             Zr-X2O3       130.2705166476
             Zr-X2O5       143.9679739506
               Zr-XO        24.2850011877
              Zr-XO2        33.4732972998
              Zr-XO3        72.3223459052
"""

def lookup_acwf_db(bravis: str):
    """bravis will be something like Si_bcc, SiO_X2O3 or something"""
    import re
    up = r"^([A-Z][a-z]?)_(sc|bcc|fcc|diamond)$"
    op = r"^([A-Z][a-z]?)([A-Z][a-z]?)_(xy|xy2|xy3|x2y|x2y3|x2y5)$"
    um, om = re.match(up, bravis), re.match(op, bravis)
    assert um or om, f"bravis required does not match any ACWF token: {bravis}"

    token = "invalid"
    if um:
        phase = um.group(2)
        phase = phase.upper() if phase.lower() != "diamond" else "Diamond"
        token = um.group(1).lower().capitalize() + "-X/" + phase
    else:
        elem = om.group(1).lower().capitalize()
        assert om.group(2).upper() == "O", f"ACWF only has oxides data available, while request is: {bravis}"
        phase = om.group(3).lower().replace("y", "O").upper()
        token = elem + "-" + phase

    for line in ACWF_REFVOLUME.split("\n"):
        if token in line: return float(line.split()[1])

    return None

def lookup_bravis_angles(bravis: str):
    
    abc_angles, _, _, _, _ = lookup_bravis_lattice(bravis, 1.0)
    _, _, _, alpha, beta, gamma = abc_angles
    return alpha, beta, gamma

def lookup_bravis_lattice(bravis: str, celldm: float):
    """lookup the lattice parameters for a given bravis lattice
    Development:
    Once new support on bravis lattice is added, the function should be updated"""
    import re
    assert re.match(r"^([A-Z][a-z]?)_(sc|bcc|fcc|diamond)$", bravis)\
        or re.match(r"^([A-Z][a-z]?[A-Z][a-z]?)_(xy|xy2|xy3|x2y|x2y3|x2y5)$", bravis)\
            , f"bravis required does not match any ACWF token: {bravis}"
    kinds, phase = bravis.split("_")
    kinds = [kinds] if phase in ["sc", "bcc", "fcc", "diamond"] else list(re.match(r"([A-Z][a-z]?)([A-Z][a-z]?)", kinds).groups())
    phase = phase.lower()
    call_map = {"sc": bravis_sc, "bcc": bravis_bcc, "fcc": bravis_fcc, "diamond": bravis_diamond,
                "xy": bravis_xy, "xy2": bravis_xy2, "xy3": bravis_xy3, 
                "x2y": bravis_x2y, "x2y3": bravis_x2y3, "x2y5": bravis_x2y5}
    return call_map[phase](kinds, celldm)

def vol_to_abc_angles(volume: float, angles: list):
    """calculate the characteristic length from the volume of the cell"""
    import numpy as np
    assert len(angles) == 3, f'angles should be a list of 3 floats: {angles}'
    if np.linalg.norm(np.array(angles) - np.array([90, 90, 90])) < 1e-6:
        return volume**(1/3)
    elif np.linalg.norm(np.array(angles) - np.array([60, 60, 60])) < 1e-6:
        return np.sqrt(2)/2 * (4*volume)**(1/3)
    elif np.linalg.norm(np.array(angles) - np.array([109.4712206, 109.4712206, 109.4712206])) < 1e-6:
        return np.sqrt(3)/2 * (2*volume)**(1/3)
    else:
        raise NotImplementedError(f'angles not supported: {angles}')

def bravis_sc(kinds: list, celldm: float):
    """build simple cubic with characteristic length `celldm`
    
    Args:
        bl (float): bond length in Angstrom
    Returns:
        lat (list): lattice parameters, including a, b, c and alpha, beta, gamma
        labels (list): atom labels, each atom has one
        kinds (list): kinds that present cell has
        labels_kinds_map (list): mapping the index of coords to kinds, size = n_atoms
        coords (np.ndarray): coordinates of atoms
    """
    assert len(kinds) == 1
    import numpy as np
    return [celldm, celldm, celldm, 90, 90, 90], kinds, kinds, \
        [0], np.array([[0, 0, 0]])

def bravis_bcc(kinds: list, celldm: float):
    """build body centered cubic with characteristic length `celldm`
    
    Args:
        bl (float): bond length in Angstrom
    Returns:
        lat (list): lattice parameters, including a, b, c and alpha, beta, gamma
        labels (list): atom labels, each atom has one
        kinds (list): kinds that present cell has
        labels_kinds_map (list): mapping the index of coords to kinds, size = n_atoms
        coords (np.ndarray): coordinates of atoms
    """
    assert len(kinds) == 1
    import numpy as np
    return [celldm, celldm, celldm, 109.4712206, 109.4712206, 109.4712206], kinds, kinds, \
        [0], np.array([[0, 0, 0]])

def bravis_fcc(kinds: list, celldm: float):
    """build face centered cubic with characteristic length `celldm`
    
    Args:
        bl (float): bond length in Angstrom
    Returns:
        lat (list): lattice parameters, including a, b, c and alpha, beta, gamma
        labels (list): atom labels, each atom has one
        kinds (list): kinds that present cell has
        labels_kinds_map (list): mapping the index of coords to kinds, size = n_atoms
        coords (np.ndarray): coordinates of atoms
    """
    assert len(kinds) == 1
    import numpy as np
    return [celldm, celldm, celldm, 60.0, 60.0, 60.0], kinds, kinds, \
        [0], np.array([[0, 0, 0]])

def bravis_diamond(kinds: list, celldm: float):
    """build diamond with characteristic length `celldm`
    
    Args:
        bl (float): bond length in Angstrom
    Returns:
        lat (list): lattice parameters, including a, b, c and alpha, beta, gamma
        labels (list): atom labels, each atom has one
        kinds (list): kinds that present cell has
        labels_kinds_map (list): mapping the index of coords to kinds, size = n_atoms
        coords (np.ndarray): coordinates of atoms
    """
    assert len(kinds) == 1
    import numpy as np
    return [celldm, celldm, celldm, 60.0, 60.0, 60.0], kinds * 2, kinds, \
        [0, 0], np.array([[0, 0, 0], [0.25, 0.25, 0.25]])

def bravis_x2y(kinds: list, celldm: float):
    """build X2Y structure with characteristic length `celldm`
    
    Args:
        bl (float): bond length in Angstrom
    Returns:
        lat (list): lattice parameters, including a, b, c and alpha, beta, gamma
        labels (list): atom labels, each atom has one
        kinds (list): kinds that present cell has
        labels_kinds_map (list): mapping the index of coords to kinds, size = n_atoms
        coords (np.ndarray): coordinates of atoms
    """
    assert len(kinds) == 2
    import numpy as np
    return [celldm, celldm, celldm, 60, 60, 60], [kinds[0]]*2 + [kinds[1]], kinds, \
        [0]*2 + [1]*1, \
        np.array([[0.75, 0.75, 0.75], [0.25, 0.25, 0.25], [0, 0, 0]])

def bravis_x2y3(kinds: list, celldm: float):
    """build X2Y3 structure with characteristic length `celldm`
    
    Args:
        bl (float): bond length in Angstrom
    Returns:
        lat (list): lattice parameters, including a, b, c and alpha, beta, gamma
        labels (list): atom labels, each atom has one
        kinds (list): kinds that present cell has
        labels_kinds_map (list): mapping the index of coords to kinds, size = n_atoms
        coords (np.ndarray): coordinates of atoms
    """
    assert len(kinds) == 2
    import numpy as np
    return [celldm, celldm, celldm, 90, 90, 90], [kinds[0]]*4 + [kinds[1]]*6, kinds, \
        [0]*4 + [1]*6, \
        np.array([[0.25, 0.25, 0.25], [0.75, 0.75, 0.25], [0.75, 0.25, 0.75], 
                    [0.25, 0.75, 0.75], 
                    [0.5, 0, 0], [0, 0.5, 0], [0, 0, 0.5], [0.5, 0.5, 0], 
                    [0.5, 0, 0.5], [0, 0.5, 0.5]])

def bravis_x2y5(kinds: list, celldm: float):
    """build X2Y5 structure with characteristic length `celldm`
    
    Args:
        bl (float): bond length in Angstrom
    Returns:
        lat (list): lattice parameters, including a, b, c and alpha, beta, gamma
        labels (list): atom labels, each atom has one
        kinds (list): kinds that present cell has
        labels_kinds_map (list): mapping the index of coords to kinds, size = n_atoms
        coords (np.ndarray): coordinates of atoms
    """
    assert len(kinds) == 2
    import numpy as np
    return [celldm, celldm, celldm, 90, 90, 90], [kinds[0]]*4 + [kinds[1]]*10, kinds, \
        [0]*4 + [1]*10, \
        np.array([[0.75, 0.75, 0.75], [0.25, 0.25, 0.75], [0.25, 0.75, 0.25],
                    [0.75, 0.25, 0.25],
                    [0.25, 0.75, 0.75], [0.75, 0.25, 0.75], [0.75, 0.75, 0.25],
                    [0.25, 0.25, 0.25], [0.5, 0.5, 0], [0.5, 0, 0.5],
                    [0, 0.5, 0.5], [0.5, 0, 0], [0, 0.5, 0],
                    [0, 0, 0.5]])

def bravis_xy(kinds: list, celldm: float):
    """build XO structure with characteristic length `celldm`
    
    Args:
        bl (float): bond length in Angstrom
    Returns:
        lat (list): lattice parameters, including a, b, c and alpha, beta, gamma
        labels (list): atom labels, each atom has one
        kinds (list): kinds that present cell has
        labels_kinds_map (list): mapping the index of coords to kinds, size = n_atoms
        coords (np.ndarray): coordinates of atoms
    """
    assert len(kinds) == 2
    import numpy as np
    return [celldm, celldm, celldm, 60, 60, 60], kinds, kinds, \
        [0]*1 + [1]*1, \
        np.array([[0, 0, 0], [0.5, 0.5, 0.5]])

def bravis_xy2(kinds: list, celldm: float):
    """build XO2 structure with characteristic length `celldm`
    
    Args:
        bl (float): bond length in Angstrom
    Returns:
        lat (list): lattice parameters, including a, b, c and alpha, beta, gamma
        labels (list): atom labels, each atom has one
        kinds (list): kinds that present cell has
        labels_kinds_map (list): mapping the index of coords to kinds, size = n_atoms
        coords (np.ndarray): coordinates of atoms
    """
    assert len(kinds) == 2
    import numpy as np
    return [celldm, celldm, celldm, 60, 60, 60], [kinds[0]]*1 + [kinds[1]]*2, kinds, \
        [0]*1 + [1]*2, \
        np.array([[0, 0, 0], [0.75, 0.75, 0.75], [0.25, 0.25, 0.25]])

def bravis_xy3(kinds: list, celldm: float):
    """build XO3 structure with characteristic length `celldm`
    
    Args:
        bl (float): bond length in Angstrom
    Returns:
        lat (list): lattice parameters, including a, b, c and alpha, beta, gamma
        labels (list): atom labels, each atom has one
        kinds (list): kinds that present cell has
        labels_kinds_map (list): mapping the index of coords to kinds, size = n_atoms
        coords (np.ndarray): coordinates of atoms
    """
    import numpy as np
    return [celldm, celldm, celldm, 60, 60, 60], [kinds[0]]*1 + [kinds[1]]*3, kinds, \
        [0]*1 + [1]*3, \
        np.array([[0, 0, 0], 
                    [0.5, 0, 0], [0, 0.5, 0], [0, 0, 0.5]])

def lookup_molecule(molecule: str, bond_length: float, **kwargs):
    """look up the molecule and build the structure
    Development:
    Once new support on molecule is added, the function should be updated to include the new molecule."""
    import re
    shapes = ["atom", "monomer", "dimer", "trimer", "tetramer", 
              "square", "tetrahedron", "triangular_bipyramid", "octahedron", "cube"]
    molepat = re.compile(rf"^([A-Z][a-z]?)_({'|'.join(shapes)})$")
    assert re.match(molepat, molecule), \
        f"The molecule '{molecule}' does not match any predefined patterns. Please ensure it is formatted correctly."
    assert isinstance(bond_length, float), f"must specify a float number as bond length: {bond_length}"
    kind, shape = molecule.split("_")
    shape = shape.lower()

    call_map = {"atom": molecule_atom, "monomer": molecule_monomer, 
                "dimer": molecule_dimer, "trimer": molecule_trimer, "tetramer": molecule_tetramer,
                "square": molecule_square, "tetrahedron": molecule_tetrahedron,
                "triangular_bipyramid": molecule_triangular_bipyramid,
                "octahedron": molecule_octahedron, "cube": molecule_cube}
    
    celldm = kwargs.get("celldm", 20.0)
    shift = [0.0]*3 if not kwargs.get("center", False) else [celldm/2]*3
    return call_map[shape](kind, bond_length, celldm, shift)

def molecule_monomer(kind: str, bl: float, celldm: float = 20.0, shift: list = [0.0, 0.0, 0.0]):
    """build monomer with bond length `bl`
    
    Args:
        bl (float): bond length in Angstrom
    Returns:
        lat (list): lattice parameters, including a, b, c and alpha, beta, gamma
        labels (list): atom labels, each atom has one
        kinds (list): kinds that present cell has
        labels_kinds_map (list): mapping the index of coords to kinds, size = n_atoms
        coords (np.ndarray): coordinates of atoms
    """
    import numpy as np
    print(f"bond length is discarded for monomer: {bl}")
    return [celldm, celldm, celldm, 90, 90, 90], [kind], [kind], \
        [0], np.array([[0, 0, 0]]) + np.array(shift)

def molecule_atom(kind: str, bl: float, celldm: float = 20.0, shift: list = [0.0, 0.0, 0.0]):
    return molecule_monomer(kind, bl, celldm, shift)

def molecule_dimer(kind: str, bl: float, celldm: float = 20.0, shift: list = [0.0, 0.0, 0.0]):
    """build dimer with bond length `bl`
    
    Args:
        bl (float): bond length in Angstrom
    Returns:
        lat (list): lattice parameters, including a, b, c and alpha, beta, gamma
        labels (list): atom labels, each atom has one
        kinds (list): kinds that present cell has
        labels_kinds_map (list): mapping the index of coords to kinds, size = n_atoms
        coords (np.ndarray): coordinates of atoms
    """
    import numpy as np
    return [celldm, celldm, celldm, 90, 90, 90], [kind, kind], [kind], \
        [0, 0], np.array([[0, 0, 0], [bl, 0, 0]]) + np.array(shift)

def molecule_trimer(kind: str, bl: float, celldm: float = 20.0, shift: list = [0.0, 0.0, 0.0]):
    """build triangle with bond length `bl`
    
    Args:
        bl (float): bond length in Angstrom
    Returns:
        lat (list): lattice parameters, including a, b, c and alpha, beta, gamma
        labels (list): atom labels, each atom has one
        kinds (list): kinds that present cell has
        labels_kinds_map (list): mapping the index of coords to kinds, size = n_atoms
        coords (np.ndarray): coordinates of atoms
    """
    import numpy as np
    return [celldm, celldm, celldm, 90, 90, 90], [kind, kind, kind], [kind], \
        [0, 0, 0], np.array([[0, 0, 0], [bl, 0, 0], [bl/2, bl/2*3**0.5, 0]]) + np.array(shift)

def molecule_tetramer(kind: str, bl: float, celldm: float = 20.0, shift: list = [0.0, 0.0, 0.0]):
    """build tetrahedron with bond length `bl`
    
    Args:
        bl (float): bond length in Angstrom
    Returns:
        lat (list): lattice parameters, including a, b, c and alpha, beta, gamma
        labels (list): atom labels, each atom has one
        kinds (list): kinds that present cell has
        labels_kinds_map (list): mapping the index of coords to kinds, size = n_atoms
        coords (np.ndarray): coordinates of atoms
    """
    import numpy as np
    return [celldm, celldm, celldm, 90, 90, 90], [kind, kind, kind, kind], [kind], \
        [0, 0, 0, 0], np.array([[0, 0, 0], [bl, 0, 0], 
            [bl/2, bl/2*3**0.5, 0], [bl/2, bl/2*3**0.5/3, bl/2*3**0.5]]) + np.array(shift)

def molecule_tetrahedron(kind: str, bl: float, celldm: float = 20.0, shift: list = [0.0, 0.0, 0.0]):
    """some alias for molecule_tetramer"""
    return molecule_tetramer(kind, bl, celldm, shift)

def molecule_square(kind: str, bl: float, celldm: float = 20.0, shift: list = [0.0, 0.0, 0.0]):
    """build square with bond length `bl`
    
    Args:
        bl (float): bond length in Angstrom
    Returns:
        lat (list): lattice parameters, including a, b, c and alpha, beta, gamma
        labels (list): atom labels, each atom has one
        kinds (list): kinds that present cell has
        labels_kinds_map (list): mapping the index of coords to kinds, size = n_atoms
        coords (np.ndarray): coordinates of atoms
    """
    import numpy as np
    return [celldm, celldm, celldm, 90, 90, 90], [kind, kind, kind, kind], [kind], \
        [0, 0, 0, 0], np.array([[0, 0, 0], [bl, 0, 0], [bl, bl, 0], [0, bl, 0]]) + np.array(shift)

def molecule_triangular_bipyramid(kind: str, bl: float, celldm: float = 20.0, shift: list = [0.0, 0.0, 0.0]):
    """build triangular bipyramid with bond length `bl`
    
    Args:
        bl (float): bond length in Angstrom
    Returns:
        lat (list): lattice parameters, including a, b, c and alpha, beta, gamma
        labels (list): atom labels, each atom has one
        kinds (list): kinds that present cell has
        labels_kinds_map (list): mapping the index of coords to kinds, size = n_atoms
        coords (np.ndarray): coordinates of atoms
    """
    import numpy as np
    return [celldm, celldm, celldm, 90, 90, 90], [kind, kind, kind, kind, kind], [kind], \
        [0, 0, 0, 0, 0], np.array(
        [[bl/3**0.5, 0, 0], 
         [-bl/2/3**0.5, bl/2, 0], 
         [-bl/2/3**0.5, -bl/2, 0], 
         [0, 0, bl*(2/3)**0.5], 
         [0, 0, -bl*(2/3)**0.5]]) + np.array(shift)

def molecule_octahedron(kind: str, bl: float, celldm: float = 20.0, shift: list = [0.0, 0.0, 0.0]):
    """build octahedron with bond length `bl`
    
    Args:
        bl (float): bond length in Angstrom
    Returns:
        lat (list): lattice parameters, including a, b, c and alpha, beta, gamma
        labels (list): atom labels, each atom has one
        kinds (list): kinds that present cell has
        labels_kinds_map (list): mapping the index of coords to kinds, size = n_atoms
        coords (np.ndarray): coordinates of atoms
    """
    import numpy as np
    return [celldm, celldm, celldm, 90, 90, 90], [kind]*6, [kind], \
        [0]*6, np.array(
        [[bl/2, bl/2, 0.0],
         [-bl/2, bl/2, 0.0],
         [-bl/2, -bl/2, 0.0],
         [bl/2, -bl/2, 0.0],
         [0.0, 0.0, bl/2**0.5],
         [0.0, 0.0, -bl/2**0.5]]) + np.array(shift)

def molecule_cube(kind: str, bl: float, celldm: float = 20.0, shift: list = [0.0, 0.0, 0.0]):
    """build cube with bond length `bl`
    
    Args:
        bl (float): bond length in Angstrom
    Returns:
        lat (list): lattice parameters, including a, b, c and alpha, beta, gamma
        labels (list): atom labels, each atom has one
        kinds (list): kinds that present cell has
        labels_kinds_map (list): mapping the index of coords to kinds, size = n_atoms
        coords (np.ndarray): coordinates of atoms
    """
    import numpy as np
    return [celldm, celldm, celldm, 90, 90, 90], [kind]*8, [kind], \
        [0]*8, np.array(
        [[bl/2, bl/2, bl/2],
         [-bl/2, bl/2, bl/2],
         [-bl/2, -bl/2, bl/2],
         [bl/2, -bl/2, bl/2],
         [bl/2, bl/2, -bl/2],
         [-bl/2, bl/2, -bl/2],
         [-bl/2, -bl/2, -bl/2],
         [bl/2, -bl/2, -bl/2]]) + np.array(shift)

import unittest
class TestMolecule(unittest.TestCase):
    def test_lookup_molecule(self):
        result = lookup_molecule("Si_dimer", 1.0, center=False)
        self.assertEqual(result[0], [20, 20, 20, 90, 90, 90])
        self.assertEqual(result[1], ['Si']*2)
        self.assertEqual(result[2], ['Si'])
        self.assertEqual(result[3], [0]*2)
        self.assertEqual(result[4].tolist(), [[0, 0, 0], [1, 0, 0]])

        result = lookup_molecule("O_trimer", 1.0, center=False)
        self.assertEqual(result[0], [20, 20, 20, 90, 90, 90])
        self.assertEqual(result[1], ['O']*3)
        self.assertEqual(result[2], ['O'])
        self.assertEqual(result[3], [0]*3)
        self.assertEqual(result[4].tolist(), [[0.0, 0.0, 0.0], [1.0, 0.0, 0.0], [0.5, 0.8660254037844386, 0.0]])

    def test_lookup_bravis_angles(self):
        result = lookup_bravis_angles("Si_sc")
        self.assertEqual(result, (90, 90, 90))

        result = lookup_bravis_angles("Si_fcc")
        self.assertEqual(result, (60, 60, 60))

        result = lookup_bravis_angles("Si_diamond")
        self.assertEqual(result, (60, 60, 60))

        result = lookup_bravis_angles("SiO_xy2")
        self.assertEqual(result, (60, 60, 60))

        result = lookup_bravis_angles("VO_xy3")
        self.assertEqual(result, (60, 60, 60))

        result = lookup_bravis_angles("VO_x2y5")
        self.assertEqual(result, (90, 90, 90))

    def test_lookup_bravis_lattice(self):
        result = lookup_bravis_lattice("Si_sc", 1.0)
        self.assertEqual(result[0], [1, 1, 1, 90, 90, 90])
        self.assertEqual(result[1], ['Si'])
        self.assertEqual(result[2], ['Si'])
        self.assertEqual(result[3], [0])
        self.assertEqual(result[4].tolist(), [[0, 0, 0]])


if __name__ == "__main__":
    unittest.main()